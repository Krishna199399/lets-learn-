import React from 'react';
import { Link, useNavigate } from 'react-router-dom';
import { motion } from 'framer-motion';
import {
    Search,
    ShoppingCart,
    User,
    Moon,
    Sun,
    Menu,
    BookOpen,
    Store,
} from 'lucide-react';
import { useAuthStore } from '../../store/useAuthStore';
import { useCartStore } from '../../store/useCartStore';
import { useThemeStore } from '../../store/useThemeStore';
import Button from '../ui/Button';

const Header: React.FC = () => {
    const { isAuthenticated, user } = useAuthStore();
    const { getTotalItems } = useCartStore();
    const { isDark, toggleTheme } = useThemeStore();
    const navigate = useNavigate();

    const totalItems = getTotalItems();

    return (
        <header className="sticky top-0 z-40 w-full border-b border-gray-200 dark:border-gray-800 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl">
            <div className="container mx-auto px-4">
                <div className="flex items-center justify-between h-16">
                    {/* Logo */}
                    <Link to="/" className="flex items-center space-x-3">
                        <img
                            src="/logo.jpg"
                            alt="Let's L-Earn and Lead"
                            className="h-10 w-auto"
                        />
                        <div className="hidden sm:flex flex-col">
                            <span className="text-lg font-bold text-gray-900 dark:text-white leading-tight">
                                LET'S <span className="text-yellow-600">L-EARN</span>
                            </span>
                            <span className="text-sm font-semibold text-gray-700 dark:text-gray-300 leading-tight">
                                AND LEAD
                                <Search className="w-5 h-5" />
                            </button>

                            {/* Theme Toggle */}
                            <button
                                onClick={toggleTheme}
                                className="p-2 text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors"
                            >
                                {isDark ? <Sun className="w-5 h-5" /> : <Moon className="w-5 h-5" />}
                            </button>

                            {/* Cart */}
                            <button
                                onClick={() => navigate('/cart')}
                                className="relative p-2 text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors"
                            >
                                <ShoppingCart className="w-5 h-5" />
                                {totalItems > 0 && (
                                    <motion.span
                                        initial={{ scale: 0 }}
                                        animate={{ scale: 1 }}
                                        className="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center"
                                    >
                                        {totalItems}
                                    </motion.span>
                                )}
                            </button>

                            {/* User Menu */}
                            {isAuthenticated ? (
                                <div className="flex items-center space-x-2">
                                    <Button
                                        variant="ghost"
                                        size="sm"
                                        onClick={() => navigate('/dashboard')}
                                        leftIcon={<User className="w-4 h-4" />}
                                    >
                                        {user?.name}
                                    </Button>
                                </div>
                            ) : (
                                <div className="flex items-center space-x-2">
                                    <Button variant="ghost" size="sm" onClick={() => navigate('/login')}>
                                        Login
                                    </Button>
                                    <Button variant="primary" size="sm" onClick={() => navigate('/signup')}>
                                        Sign Up
                                    </Button>
                                </div>
                            )}

                            {/* Mobile Menu */}
                            <button className="md:hidden p-2 text-gray-600 dark:text-gray-400">
                                <Menu className="w-5 h-5" />
                            </button>
                        </div>
                </div>
            </div>
        </header>
    );
};

export default Header;
